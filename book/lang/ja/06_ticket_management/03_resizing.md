# リサイズ

`Vec`は「成長可能な」ベクタ型だと言いましたが、それはどういう意味でしょうか？
すでに最大容量に達している`Vec`に要素を挿入しようとするとどうなるでしょうか？

```rust
let mut numbers = Vec::with_capacity(3);
numbers.push(1);
numbers.push(2);
numbers.push(3); // 最大容量に到達
numbers.push(4); // ここで何が起こるか？
```

`Vec`は自分自身を**リサイズ**します。\
アロケータに新しい（より大きな）ヒープメモリのチャンクを要求し、要素をコピーし、古いメモリを解放します。

この操作は、新しいメモリ割り当てと既存のすべての要素のコピーを伴うため、コストが高くなる可能性があります。

## `Vec::with_capacity`

`Vec`に保存する要素数の大まかな見積もりがある場合は、`Vec::with_capacity`メソッドを使用して事前に十分なメモリを割り当てることができます。\
これにより、`Vec`が成長する際の新しい割り当てを回避できますが、実際の使用量を過大評価するとメモリを無駄にする可能性があります。

ケースバイケースで評価してください。