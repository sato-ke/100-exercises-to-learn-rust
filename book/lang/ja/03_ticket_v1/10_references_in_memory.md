# 参照

`&String`や`&mut String`のような参照はどうでしょうか？メモリでどのように表現されるのでしょうか？

Rustのほとんどの参照[^fat]は、メモリ内では、メモリ位置へのポインタとして表現されます。  
したがって、そのサイズはポインタのサイズ、つまり`usize`と同じです。

`std::mem::size_of`を使用してこれを確認できます：

```rust
assert_eq!(std::mem::size_of::<&String>(), 8);
assert_eq!(std::mem::size_of::<&mut String>(), 8);
```

特に`&String`は、`String`のメタデータが格納されているメモリ位置へのポインタです。  
このスニペットを実行すると：

```rust
let s = String::from("Hey");
let r = &s;
```

メモリでこのようなものが得られます：

```
           --------------------------------------
           |                                    |
      +----v----+--------+----------+      +----|----+
Stack | pointer | length | capacity |      | pointer |
      |  |      |   3    |    5     |      |         |
      +--|  ----+--------+----------+      +---------+
         |          s                           r
         |
         v
       +---+---+---+---+---+
Heap   | H | e | y | ? | ? |
       +---+---+---+---+---+
```

言うなれば、ヒープ割り当てデータへのポインタへのポインタです。
`&mut String`についても同様です。

## すべてのポインタがヒープを指すわけではない

上記の例では一つのことを明確にするはずです：すべてのポインタがヒープを指すわけではありません。  
それらは単にメモリ位置を指すだけで、それがヒープにある_かもしれませんが_、そうでなくても構いません。

[^fat]: [コースの後半で](../04_traits/06_str_slice.md)**ファットポインタ**について話します。
つまり、追加のメタデータを持つポインタです。名前が示すように、それらは
この章で議論したポインタ、**シンポインタ**としても知られるものより大きいです。