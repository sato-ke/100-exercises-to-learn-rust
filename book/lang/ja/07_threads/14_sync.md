# `Sync`

この章を終える前に、Rustの標準ライブラリの別の重要なトレイトについて話しましょう：`Sync`。

`Sync`は`Send`と同様に自動トレイトです。\
スレッド間で安全に**共有**できるすべての型によって自動的に実装されます。

言い換えると：`&T`が`Send`であれば、`T`は`Sync`です。

## `T: Sync`は`T: Send`を意味しない

`T`が`Send`でなくても`Sync`である可能性があることは重要です。\
例えば：`MutexGuard`は`Send`ではありませんが、`Sync`です。

ロックを取得したのと同じスレッドでロックを解放する必要があるため、`Send`ではありません。したがって、
`MutexGuard`が異なるスレッドでドロップされることは望ましくありません。\
しかし、別のスレッドに`&MutexGuard`を与えることはロックが解放される場所に影響を与えないため、`Sync`です。

## `T: Send`は`T: Sync`を意味しない

その逆も真です：`T`は`Sync`でなくても`Send`である可能性があります。\
例えば：`RefCell<T>`は（`T`が`Send`であれば）`Send`ですが、`Sync`ではありません。

`RefCell<T>`はランタイム借用チェックを実行しますが、借用を追跡するために使用するカウンタはスレッドセーフではありません。
したがって、複数のスレッドが`&RefCell`を保持することはデータ競合につながり、
複数のスレッドが同じデータへの可変参照を取得する可能性があります。したがって、`RefCell`は`Sync`ではありません。\
代わりに、`RefCell`を別のスレッドに送信するときは、含まれるデータへの参照を残さないため、
並行可変アクセスのリスクがないため、`Send`は問題ありません。